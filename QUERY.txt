***************narcotic table*******************

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'GANJA');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'LSD');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'MAGIC MASHROOM');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'MDMA');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'PHENSEDYL');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'COCAINE');

insert into narcotics(drug_id,drug_name)
values(DEFAULT,'HEROIN');


****************************DISTRICTS*********************

insert into districts(district_id,district_name)
values(DEFAULT,'DARJEELING');

insert into districts(district_id,district_name)
values(DEFAULT,'KOLKATA');

insert into districts(district_id,district_name)
values(DEFAULT,'BANKURA');

insert into districts(district_id,district_name)
values(DEFAULT,'PURBO MEDINIPUR');

insert into districts(district_id,district_name)
values(DEFAULT,'MALDA');

insert into districts(district_id,district_name)
values(DEFAULT,'PASCHIM MEDINIPUR');

insert into districts(district_id,district_name)
values(DEFAULT,'PURULIA');

insert into districts(district_id,district_name)
values(DEFAULT,'HOOGLY');

insert into districts(district_id,district_name)
values(DEFAULT,'HOWRAH');

insert into districts(district_id,district_name)
values(DEFAULT,'NORTH 24 PARGANAS');

**********************************PS_DETAILS**********************

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,2,'AMHERST STREET PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,2,'NARKELDANGA PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,10,'BIDHANNAGAR SOUTH PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,10,'BARASAT PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,10,'BARASAT PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,8,'CHANDANNAGAR PS');

insert into ps_details(ps_id,district_id,ps_name)
values(DEFAULT,8,'CHINSURA PS');

***********************COURT_DETAILS**********************

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 1ST COURT SILIGURI',22);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM,MIRIK',22);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'METROPOLITAN MAGISTRATE,13TH COURT,CALCUTTA',23);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 1ST COURT BARRACKPUR',31);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 2ND COURT BARASAT',31);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 2ND COURT HOWRAH',30);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 2ND COURT SERAMPORE',29);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 2ND COURT CHANDANNAGAR',29);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 7TH COURT BANKURA',24);

insert into court_details(court_id,court_name,district_id)
values(DEFAULT,'JM 1ST COURT PURULIA',28);

*************************************AGENCY_DETAILS***********************

insert into agency_details(agency_id,agency_name)
values(DEFAULT,'CID');

insert into agency_details(agency_id,agency_name)
values(DEFAULT,'CBI');

insert into agency_details(agency_id,agency_name)
values(DEFAULT,'NIA');

insert into agency_details(agency_id,agency_name)
values(DEFAULT,'NCB');

insert into agency_details(agency_id,agency_name)
values(DEFAULT,'KOLKATA POLICE');

**************************************STROAGE_DETAILS******************

insert into storage_details(storage_id,storage_name,district_id)
values(DEFAULT,'CENTRAL MALKHANA,LALBAJAR',2);

insert into storage_details(storage_id,storage_name,district_id)
values(DEFAULT,'MALKHANA,VABANIVABAN',10);

*************************************UNIT********************

insert into units(unit_id,unit_name)
values(DEFAULT,'GRAM');

insert into units(unit_id,unit_name)
values(DEFAULT,'KG');

insert into units(unit_id,unit_name)
values(DEFAULT,'LITRE');

insert into units(unit_id,unit_name)
values(DEFAULT,'KILOLITRE');


****************fetching unit_name******************************

select s.quantity_of_drug,u1.unit_name seizure_unit, s.disposal_quantity, u2.unit_name disposal_unit,
		s.undisposed_quantity,u3.unit_name undisposed_unit_name
		from seizures s inner join units u1 on cast(s.unit_name as int)=u1.unit_id 
		inner join units u2 on cast(s.unit_of_disposal_quantity as int)=u2.unit_id 
		inner join units u3 on cast(s.undisposed_unit as int)=u3.unit_id



*****************************fetching stakeholder wise disposed & undisposed tally*****************
select disposal_query.agency_name, disposed+undisposed as seizures, disposal_query.disposed as disposed, undisposal_query.undisposed as undisposed
from 

(select agency_name, count(disposal.disposal_quantity) as disposed
from agency_details left join (select * from seizures where disposal_quantity IS NOT NULL) as disposal
on agency_details.agency_id = disposal.agency_id
group by agency_name) as disposal_query

INNER JOIN 

(select agency_name, count(undisposal.quantity_of_drug) as undisposed
from agency_details left join (select * from seizures where disposal_quantity IS NULL) as undisposal
on agency_details.agency_id = undisposal.agency_id
group by agency_name) as undisposal_query

on disposal_query.agency_name = undisposal_query.agency_name
order by undisposed DESC

********************************Report Query**********************************************************************
SELECT 
       drug_name,
       SUM(A) disposal_quantity,
       SUM(B) undisposed_quantity
FROM 
(
       select drug_name, 
              CASE 
					WHEN disposal_flag = 'Y' THEN disposal_quantity ELSE 0 END as A,
			  CASE
					WHEN disposal_flag = 'Y' THEN quantity_of_drug-quantity_of_sample-disposal_quantity 
					ELSE quantity_of_drug-coalesce(quantity_of_sample, 0) END as B
       from  seizures inner join narcotics on seizures.drug_id = narcotics.drug_id
) t
GROUP BY drug_name


